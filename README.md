# Lucetune Fanlink 系统

## 简介

Lucetune Fanlink 系统是一个自动化的音乐链接聚合页面生成工具，支持按厂牌和歌曲编号组织URL结构，提供统一的音乐发行页面解决方案。系统会智能处理厂牌重名和歌曲编号冲突，只需简单配置即可生成专业的Fanlink页面，为音乐发行提供便捷的链接管理方式。

## 功能特性

- 自动生成结构化的音乐链接页面
- 智能处理厂牌重名和歌曲编号冲突
- 支持多种主流音乐平台链接（QQ音乐、Spotify、网易云音乐、Apple Music、SoundCloud）
- 简洁美观的页面设计，自动适配封面图片
- 灵活的URL结构，支持厂牌区分和歌曲编号
- 一键生成所有歌曲页面，操作简单高效

## 快速开始

### 1. 环境准备
- 确保已安装Node.js环境
- 克隆或下载本项目到本地

### 2. 准备封面图片
- 将歌曲封面图片放入 `cover/` 文件夹
- 确保文件名清晰且与配置文件中的引用一致
- 支持JPG、PNG等常见图片格式

### 3. 添加歌曲信息
- 打开 `songs.json` 文件
- 复制 `songs-template.json` 中的模板条目
- 根据实际情况修改歌曲信息
- 示例配置：
  ```json
  [
    {
      "label_name": "厂牌名称",
      "label_id": 1,
      "artist": "艺人名称",
      "song_number": 1,
      "song_title": "歌曲标题",
      "cover": "封面图片文件名.jpg",
      "links": {
        "qqmusic": "QQ音乐链接",
        "spotify": "Spotify链接",
        "netease": "网易云音乐链接",
        "applemusic": "Apple Music链接",
        "soundcloud": "SoundCloud链接"
      }
    }
  ]
  ```

### 4. 生成Fanlink页面
- 运行以下命令生成页面：
  ```bash
  node generate-fanlinks.js
  ```
- 系统会自动创建所需的文件夹结构和HTML文件
- 生成完成后会显示所有创建的页面信息和路径

### 5. 访问生成的页面
- 通过以下URL格式访问：
  ```
  fan.lucetune.com/[厂牌名]/[歌曲编号]
  ```
- 当厂牌重名时：
  ```
  fan.lucetune.com/[厂牌名-厂牌编号]/[歌曲编号]
  ```
- 示例：
  - `fan.lucetune.com/lbd-records/1`
  - `fan.lucetune.com/lbd-records-2/1`

## 本地预览

可以使用HTTP服务器在本地预览生成的页面：

```bash
# 安装http-server（如果尚未安装）
npm install -g http-server

# 启动服务器
http-server -p 8000

# 访问页面
# http://localhost:8000/artist/[厂牌名]/[歌曲编号]/index.html
```

## 核心文件说明

- **`songs.json`**：歌曲数据配置文件，包含所有歌曲信息
- **`songs-template.json`**：配置模板，用于快速添加新歌曲
- **`generate-fanlinks.js`**：自动生成脚本，处理数据并创建页面
- **`index.html`**：HTML模板文件，定义页面结构和样式
- **`cover/`**：存放所有歌曲封面图片的目录
- **`artist/`**：生成的Fanlink页面输出目录（原dist目录）
- **`assets/`**：存放SVG图标等静态资源

## 自动处理规则

1. **厂牌命名规则**：
   - 不重名时：使用简化格式 `厂牌名`
   - 重名时：使用 `厂牌名-厂牌编号` 格式

2. **ID自动分配**：
   - 如果未指定 `label_id` 或 `song_number`，系统会自动分配可用编号
   - 同厂牌下歌曲编号冲突时，会自动顺延

3. **链接处理**：
   - 支持QQ音乐、Spotify、网易云音乐、Apple Music和SoundCloud
   - 为空的链接将使用 `#` 作为占位符
   - 仅显示已配置的平台图标

4. **文件路径处理**：
   - 自动复制封面图片到输出目录
   - 处理中文字符和特殊字符的路径

## 配置详解

### 必须字段
- `label_name`：厂牌名称
- `artist`：艺人名称
- `song_title`：歌曲标题
- `cover`：封面图片文件名

### 可选字段
- `label_id`：厂牌ID（默认自动分配）
- `song_number`：歌曲编号（默认自动分配）
- `links`：各平台链接对象（缺少时使用占位符）

## 注意事项

1. **服务器配置**：确保服务器支持通过文件夹路径访问index.html（需要正确的重写规则）
2. **更新流程**：修改 `songs.json` 后需重新运行生成脚本以更新页面
3. **删除歌曲**：如需删除歌曲，请从 `songs.json` 移除对应条目并重新生成
4. **封面图片**：确保所有封面图片都放在 `cover/` 目录下，文件名与配置一致
5. **重新生成**：运行脚本会覆盖已存在的文件，确保操作前备份重要数据
6. **文件权限**：确保具有对项目目录的读写权限，特别是对 `artist/` 目录

## 故障排除

### 常见问题

1. **页面无法访问**
   - 检查服务器配置是否正确
   - 确认文件路径和文件名是否正确
   - 验证index.html文件是否存在于正确位置

2. **封面图片不显示**
   - 检查cover字段是否与实际文件名完全一致
   - 确保图片格式受支持
   - 验证相对路径是否正确

3. **平台图标显示异常**
   - 检查SVG图标文件是否存在于assets/svg目录
   - 确保链接格式正确（以http/https开头）

## 更新日志

### 最新更新
- 输出目录从 `dist/` 更改为 `artist/`
- 优化正则表达式以确保正确匹配和替换脚本块
- 改进文件路径处理逻辑，支持更复杂的命名

## 许可证

保留所有权利。

---

*Lucetune Fanlink 系统 - 为音乐发行提供专业的链接管理解决方案*